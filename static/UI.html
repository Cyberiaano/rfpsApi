<!DOCTYPE html>
<html>
<head>
  <title>Document Manager</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 2em; background-color: #f5f7fa; color: #333; }
    h1, h2 { color: #1a73e8; }
    form { display: flex; align-items: center; gap: 10px; margin-bottom: 1.5em; }
    input[type="file"] { padding: 6px; border: 1px solid #ccc; border-radius: 5px; background-color: #fff; }
    button { padding: 8px 16px; border: none; border-radius: 5px; background-color: #1a73e8; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }
    button:hover { background-color: #155ab6; transform: translateY(-2px); }
    table { border-collapse: collapse; width: 100%; background-color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }
    th, td { border-bottom: 1px solid #ddd; padding: 12px 15px; text-align: left; }
    th { background-color: #1a73e8; color: white; font-weight: bold; }
    tr:hover { background-color: #f1f7ff; }
    a { text-decoration: none; color: #1a73e8; font-weight: bold; transition: color 0.3s; }
    a:hover { color: #155ab6; }
    .delete-btn { background-color: #e53935; margin-left: 5px; }
    .delete-btn:hover { background-color: #b71c1c; }
  </style>
</head>
<body>
  <h1>ðŸ“„ RFPs Manager</h1>

  <form id="uploadForm">
    <input type="file" id="fileInput" accept=".pdf,.docx,.txt" required />
    <button type="submit">Upload</button>
  </form>

  <h2>Uploaded RFPs</h2>
  <table id="fileTable">
    <thead>
      <tr><th>ID</th><th>Filename</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const form = document.getElementById("uploadForm");
    const table = document.getElementById("fileTable").querySelector("tbody");

    async function loadFiles() {
      const res = await fetch("/documents");
      const files = await res.json();
      table.innerHTML = files.map(f => `
        <tr>
          <td>${f.id}</td>
          <td>${f.filename}</td>
          <td>
            <a href="${f.download_url}" target="_blank">Download</a>
            <button class="delete-btn" onclick="deleteFile('${f.id}')">Delete</button>
          </td>
        </tr>
      `).join("");
    }

    async function deleteFile(id) {
      if (!confirm("Are you sure you want to delete this file?")) return;
      await fetch(`/delete/${id}`, { method: 'DELETE' });
      await loadFiles();
    }

    form.onsubmit = async (e) => {
      e.preventDefault();
      const file = document.getElementById("fileInput").files[0];
      const formData = new FormData();
      formData.append("file", file);
      await fetch("/upload", { method: "POST", body: formData });
      await loadFiles();
    };

    loadFiles();
  </script>
</body>
</html>
